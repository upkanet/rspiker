<html>

<head>
    <title>Axorus - Spiker</title>
</head>
<style>
    body {
        background-color: black;
        font-family: Arial, Helvetica, sans-serif;
        color: white;
        margin: 0;
    }

    a {
        color: white;
    }
</style>
<script src="js/jquery3.5.1.min.js"></script>
<script src="js/plotly-latest.min.js"></script>
<script>
    var layoutBlack = { paper_bgcolor: 'black', plot_bgcolor: 'black', font: { color: 'white' }, xaxis: {'title': '', ticksuffix:'', spikemode: 'toaxis'}, yaxis: {spikemode: 'toaxis'}, hovermode: 'closest' };

    function plotEdata(electrode,mod,srateName,plotName,title,ticksuffix){
        $.getJSON(`/electrode/${mod}/${electrode}`, function (el) {
            console.log(el);
            var data = el;
            //var sample_rate = el[srateName];
            var sample_rate = 20000;
            var d = {x: data.map((x,index) => index / sample_rate), y: data.map(x => x), type: 'line' };
            layoutBlack.xaxis.title = title;
            layoutBlack.xaxis.ticksuffix = ticksuffix;
            Plotly.newPlot(plotName, [d], layoutBlack);
        });
    }
    function plotERaster(electrode,timewidth){
        $.getJSON(`/electrode/s/${electrode}`, function (data) {
            console.log(data);
            var sample_rate = 20000;
            var w = 1000;
            var h = 1000;
            var tw = timewidth;
            var th = Math.round((data.length / sample_rate) / tw);

            var canvas = document.getElementById("gRaster");
            var ctx = canvas.getContext('2d');
            ctx.fillStyle="blue";

            data.forEach((v,k) => {
                if(v > 0){
                    var t = k / sample_rate;
                    var x = t%tw / tw;
                    var y = Math.round(t/tw) / th;
                    ctx.fillRect(x * w,y * h,2,20);
                    console.log(x * w,y * h);
                }
            });

        });
    }

</script>

<body>
    <div id="gElectrode" style="width:100%;height:100%;"></div>
    <canvas id="gRaster"  width="1000" height="1000"></canvas>
</body>

</html>